import{f as y,h as Ie,a as d,t as u,s as ce,e as Le}from"../chunks/tMh-h1UU.js";import{i as Oe}from"../chunks/B92wWaER.js";import{p as je,o as Ae,a as Ye,$ as qe,s as l,m as c,c as o,b as r,g as t,r as s,d as i,t as U,i as Ge,f as He}from"../chunks/4Z14Qsdb.js";import{i as pe}from"../chunks/epDpuhXI.js";import{a as Je,b as me,t as C,e as Ke,i as Qe,r as Re,B as _e,c as Ue}from"../chunks/BklcvC6Y.js";import{I as f,b as Ve}from"../chunks/t8x5iSCf.js";import{L as m}from"../chunks/VF2rYq1k.js";var We=y('<div class="flex items-center justify-center py-12"><div class="text-muted-foreground">加载中...</div></div>'),Xe=y("<option> </option>"),Ze=y('<div class="space-y-2 ml-6"><!> <!></div> <div class="space-y-2 ml-6"><!> <!> <p class="text-sm text-muted-foreground">小于此大小的文件不使用多线程下载（默认 10MB）</p></div>',1),ea=y('<form class="space-y-8"><div class="space-y-6"><h2 class="text-lg font-semibold">文件命名模板</h2> <div class="space-y-2"><!> <!> <p class="text-sm text-muted-foreground">可用变量：&#123;&#123;title&#125;&#125;, &#123;&#123;bvid&#125;&#125;, &#123;&#123;avid&#125;&#125;</p></div> <div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!> <p class="text-sm text-muted-foreground">可用变量：&#123;&#123;title&#125;&#125;, &#123;&#123;pid&#125;&#125;, &#123;&#123;pid_pad&#125;&#125;</p></div> <div class="space-y-2"><!> <!> <p class="text-sm text-muted-foreground">可用变量：&#123;&#123;season&#125;&#125;, &#123;&#123;season_pad&#125;&#125;, &#123;&#123;pid&#125;&#125;, &#123;&#123;pid_pad&#125;&#125;</p></div> <div class="space-y-2"><!> <!></div></div> <div class="space-y-6"><h2 class="text-lg font-semibold">系统设置</h2> <div class="space-y-2"><!> <!> <p class="text-sm text-muted-foreground">Python strftime 格式</p></div> <div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <select id="nfo-time-type" class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"></select></div></div> <div class="space-y-6"><h2 class="text-lg font-semibold">下载设置</h2> <div class="flex items-center space-x-2"><input type="checkbox" id="parallel-download" class="h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"/> <!></div> <!></div> <div class="flex gap-2 pt-4 border-t"><!> <!></div></form>'),aa=y('<div class="max-w-4xl mx-auto"><div class="bg-card rounded-lg shadow-sm border p-6"><h1 class="text-2xl font-bold mb-6">系统设置</h1> <!></div></div>');function na(fe,ge){je(ge,!1);let p=null,D=c(!1),x=c(!1),w=c(""),P=c(""),T=c(""),k=c(""),z=c(""),B=c(""),F=c(1200),$=c("FavTime"),b=c(!1),N=c(4),S=c(10485760);const $e=[{value:"FavTime",label:"收藏时间"},{value:"PubTime",label:"发布时间"}];Ae(async()=>{Je([{label:"主页",href:"/"},{label:"设置",isActive:!0}]),await V()});async function V(){l(D,!0);try{p=(await me.getConfig()).data,l(w,p.video_name||""),l(P,p.page_name||""),l(T,p.multi_page_name||""),l(k,p.bangumi_name||""),l(z,p.folder_structure||""),l(B,p.time_format||""),l(F,p.interval||1200),l($,p.nfo_time_type||"FavTime"),l(b,p.parallel_download_enabled||!1),l(N,p.parallel_download_threads||4),l(S,p.parallel_download_min_size||10485760)}catch(v){console.error("加载配置失败:",v),C.error("加载配置失败",{description:v.message})}finally{l(D,!1)}}async function be(){l(x,!0);try{const v={video_name:t(w),page_name:t(P),multi_page_name:t(T),bangumi_name:t(k),folder_structure:t(z),time_format:t(B),interval:t(F),nfo_time_type:t($),parallel_download_enabled:t(b),parallel_download_threads:t(N),parallel_download_min_size:t(S)},_=await me.updateConfig(v);_.data.success?C.success("保存成功",{description:_.data.message}):C.error("保存失败",{description:_.data.message})}catch(v){console.error("保存配置失败:",v),C.error("保存失败",{description:v.message})}finally{l(x,!1)}}Oe();var M=aa();Ie(v=>{qe.title="设置 - Bili Sync"});var W=o(M),he=r(o(W),2);{var ye=v=>{var _=We();d(v,_)},xe=v=>{var _=ea(),E=o(_),I=r(o(E),2),X=o(I);m(X,{for:"video-name",children:(e,n)=>{i();var a=u("视频文件名");d(e,a)},$$slots:{default:!0}});var we=r(X,2);f(we,{id:"video-name",placeholder:"{{title}}",get value(){return t(w)},set value(e){l(w,e)},$$legacy:!0}),i(2),s(I);var L=r(I,2),Z=o(L);m(Z,{for:"page-name",children:(e,n)=>{i();var a=u("分P视频名");d(e,a)},$$slots:{default:!0}});var Pe=r(Z,2);f(Pe,{id:"page-name",placeholder:"{{title}}",get value(){return t(P)},set value(e){l(P,e)},$$legacy:!0}),s(L);var O=r(L,2),ee=o(O);m(ee,{for:"multi-page-name",children:(e,n)=>{i();var a=u("多P视频名");d(e,a)},$$slots:{default:!0}});var Te=r(ee,2);f(Te,{id:"multi-page-name",placeholder:"{{title}}-P{{pid_pad}}",get value(){return t(T)},set value(e){l(T,e)},$$legacy:!0}),i(2),s(O);var j=r(O,2),ae=o(j);m(ae,{for:"bangumi-name",children:(e,n)=>{i();var a=u("番剧文件名");d(e,a)},$$slots:{default:!0}});var ke=r(ae,2);f(ke,{id:"bangumi-name",placeholder:"S{{season_pad}}E{{pid_pad}}-{{pid_pad}}",get value(){return t(k)},set value(e){l(k,e)},$$legacy:!0}),i(2),s(j);var te=r(j,2),re=o(te);m(re,{for:"folder-structure",children:(e,n)=>{i();var a=u("文件夹结构");d(e,a)},$$slots:{default:!0}});var ze=r(re,2);f(ze,{id:"folder-structure",placeholder:"Season 1",get value(){return t(z)},set value(e){l(z,e)},$$legacy:!0}),s(te),s(E);var A=r(E,2),Y=r(o(A),2),le=o(Y);m(le,{for:"time-format",children:(e,n)=>{i();var a=u("时间格式");d(e,a)},$$slots:{default:!0}});var Be=r(le,2);f(Be,{id:"time-format",placeholder:"%Y-%m-%d",get value(){return t(B)},set value(e){l(B,e)},$$legacy:!0}),i(2),s(Y);var q=r(Y,2),se=o(q);m(se,{for:"interval",children:(e,n)=>{i();var a=u("扫描间隔（秒）");d(e,a)},$$slots:{default:!0}});var Fe=r(se,2);f(Fe,{id:"interval",type:"number",min:"60",placeholder:"1200",get value(){return t(F)},set value(e){l(F,e)},$$legacy:!0}),s(q);var oe=r(q,2),de=o(oe);m(de,{for:"nfo-time-type",children:(e,n)=>{i();var a=u("NFO 时间类型");d(e,a)},$$slots:{default:!0}});var G=r(de,2);U(()=>{t($),Ge(()=>{})}),Ke(G,5,()=>$e,Qe,(e,n)=>{var a=Xe(),h={},Q=o(a,!0);s(a),U(()=>{h!==(h=t(n).value)&&(a.value=(a.__value=t(n).value)??""),ce(Q,t(n).label)}),d(e,a)}),s(G),s(oe),s(A);var H=r(A,2),J=r(o(H),2),K=o(J);Re(K);var Ne=r(K,2);m(Ne,{for:"parallel-download",class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:(e,n)=>{i();var a=u("启用多线程下载");d(e,a)},$$slots:{default:!0}}),s(J);var Se=r(J,2);{var Ce=e=>{var n=Ze(),a=He(n),h=o(a);m(h,{for:"threads",children:(g,Ee)=>{i();var R=u("下载线程数");d(g,R)},$$slots:{default:!0}});var Q=r(h,2);f(Q,{id:"threads",type:"number",min:"1",max:"16",placeholder:"4",get value(){return t(N)},set value(g){l(N,g)},$$legacy:!0}),s(a);var ve=r(a,2),ue=o(ve);m(ue,{for:"min-size",children:(g,Ee)=>{i();var R=u("最小文件大小（字节）");d(g,R)},$$slots:{default:!0}});var Me=r(ue,2);f(Me,{id:"min-size",type:"number",min:"0",placeholder:"10485760",get value(){return t(S)},set value(g){l(S,g)},$$legacy:!0}),i(2),s(ve),d(e,n)};pe(Se,e=>{t(b)&&e(Ce)})}s(H);var ie=r(H,2),ne=o(ie);_e(ne,{type:"submit",get disabled(){return t(x)},children:(e,n)=>{i();var a=u();U(()=>ce(a,t(x)?"保存中...":"保存设置")),d(e,a)},$$slots:{default:!0}});var De=r(ne,2);_e(De,{type:"button",variant:"outline",onclick:V,children:(e,n)=>{i();var a=u("重置");d(e,a)},$$slots:{default:!0}}),s(ie),s(_),Le("submit",_,e=>{e.preventDefault(),be()}),Ue(G,()=>t($),e=>l($,e)),Ve(K,()=>t(b),e=>l(b,e)),d(v,_)};pe(he,v=>{t(D)?v(ye):v(xe,!1)})}s(W),s(M),d(fe,M),Ye()}export{na as component};
